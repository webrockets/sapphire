= component 'page-title', title: 'Listing Users' do
  - if can? :create, User
    = link_to new_admin_user_path, class: 'button is-link is-pulled-right' do
        span.icon
          i.fas.fa-plus
        span New User

= component 'breadcrumb' do
  li.is-active
    a Users

.card
  table.table.is-striped.is-hoverable.is-fullwidth
    .card-header
      thead
        tr
          th Name
          th Email
          th Role
          th Since
          th Sign In Count
          th Last Sign In
          th Status
          th style="width: 10%" Actions

    tbody
      - @users.each do |user|
        tr
          td = link_to user.name, admin_user_path(user)
          td = user.email
          td
            - if can? :change_role, user
              select-role user-id="#{user.id}" role="#{user.role}" :options="#{User.role.options}"
            - else
              = user.role.text
          td = user.created_at.strftime('%Y/%m/%d at %I:%M %P')
          td = user.sign_in_count
          td = user.last_sign_in_at&.strftime('%Y/%m/%d at %I:%M %P')
          td
            - if user.confirmed_at
              span.icon.has-text-success title="Confirmed"
                i.fas.fa-envelope
            - else
              span.icon.has-text-danger title="unconfirmed"
                i.fas.fa-envelope

            - if user.locked_at
              span.icon.has-text-danger title="Locked"
                i.fas.fa-ban
            - else
              span.icon.has-text-success title="Unlocked"
                i.fas.fa-check-circle
          td
            - if can? :update, user
              = link_to edit_admin_user_path(user), class: 'button is-light is-small mr5', title: 'Edit' do
                span.icon
                  i.fas.fa-pencil-alt
            - if can? :destroy, user
              = link_to admin_user_path(user), data: { confirm: 'Are you sure?' }, method: :delete, class: 'button is-small is-danger mr5', title: 'Destroy' do
                span.icon
                  i.fas.fa-trash
